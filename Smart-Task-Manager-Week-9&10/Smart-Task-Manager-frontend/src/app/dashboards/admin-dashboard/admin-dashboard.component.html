<div class="container mx-auto p-4">
  <div class="flex justify-between items-center mb-6">
    <!-- Dashboard heading -->
    <h1 class="text-3xl font-bold">Admin Dashboard</h1>
    <!-- Logout button that calls the logout() method in the component -->
    <button (click)="logout()" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
      Logout
    </button>
  </div>

  <!-- Section title for user management -->
  <h2 class="text-2xl font-semibold mb-4">User Management</h2>
  <div class="overflow-x-auto bg-white shadow-md rounded-lg p-4">
    <table class="min-w-full table-auto">
      <!-- Table header -->
      <thead>
        <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
          <th class="py-3 px-6 text-left">ID</th>
          <th class="py-3 px-6 text-left">Username</th>
          <th class="py-3 px-6 text-left">Email</th>
          <th class="py-3 px-6 text-left">Role</th>
          <th class="py-3 px-6 text-center">Actions</th>
        </tr>
      </thead>
      <!-- Table body: Loops through the 'users' array -->
      <tbody class="text-gray-600 text-sm font-light">
        <!-- *ngFor creates one <tr> for each user in the users list -->
        <tr *ngFor="let user of users" class="border-b border-gray-200 hover:bg-gray-100">
          <td class="py-3 px-6 text-left">{{ user.id }}</td>
          <td class="py-3 px-6 text-left">{{ user.username }}</td>
          <td class="py-3 px-6 text-left">{{ user.email }}</td>
          <!-- Dropdown to change user role -->
          <td class="py-3 px-6 text-left">
            <!-- When selection changes, call updateUserRole() with user ID and event -->
            <select (change)="updateUserRole(user.id, $event)" class="bg-white border rounded p-1">
              <!-- Loop through available roles -->
              <option *ngFor="let role of roles" [value]="role" [selected]="hasRole(user, role)">
                {{ role }}
              </option>
            </select>
          </td>
          <!-- Delete button -->
          <td class="py-3 px-6 text-center">
            <!-- Clicking this calls deleteUser() with the user ID -->
            <button (click)="deleteUser(user.id)" class="bg-red-500 text-white rounded-full p-2 hover:bg-red-600 flex items-center justify-center" title="Delete User">
              <!-- Trash can icon -->
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="white" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1H9a1 1 0 00-1 1v3M4 7h16" />
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div style="width: 70%; margin: auto;">
    <canvas baseChart
            [data]="completionData"
            [options]="barChartOptions"
            chartType="barChartType">
    </canvas>
  </div>

  <hr>

  <h3>Generate Report</h3>
  <div class="filters">
    <label>Status:
      <select [(ngModel)]="selectedStatus">
        <option value="">All</option>
        <option>To Do</option>
        <option>In Progress</option>
        <option>Completed</option>
      </select>
    </label>

    <label>Assignee ID:
      <input type="number" [(ngModel)]="assigneeId">
    </label>

    <label>Start Date:
      <input type="date" [(ngModel)]="startDate">
    </label>

    <label>End Date:
      <input type="date" [(ngModel)]="endDate">
    </label>
  </div>

  <div class="actions">
    <button (click)="downloadReport('pdf')">Download PDF</button>
    <button (click)="downloadReport('excel')">Download Excel</button>
  </div>

</div>
